<header class="header">
  <div class="container">
    <div class="header-content">
      <a routerLink="/" class="logo" (click)="closeMobileMenu()">
        <h1><span class="moto-text">MOTO</span>–º–∞—Ä–∫–µ—Ç</h1>
      </a>
      <div class="header-actions">
        <a routerLink="/cart" class="cart-link-header" (click)="closeMobileMenu()" aria-label="–ö–æ—Ä–∑–∏–Ω–∞">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 2L7 6m10 0l-2-4M3 6h18l-1 7H4L3 6zM4 13h16l-1 7H5l-1-7z" />
            <circle cx="9" cy="20" r="1" />
            <circle cx="20" cy="20" r="1" />
          </svg>
          <span *ngIf="cartCount > 0" class="cart-badge-header">{{ cartCount }}</span>
        </a>
        <a href="tel:+79625167301" class="phone-link" (click)="closeMobileMenu()" aria-label="–ü–æ–∑–≤–æ–Ω–∏—Ç—å">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path
              d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" />
          </svg>
          <span class="phone-text">+7 (962) 516-73-01</span>
        </a>
      </div>
      <button class="mobile-menu-toggle" (click)="toggleMobileMenu()" aria-label="–ú–µ–Ω—é">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <nav class="nav" [class.mobile-open]="mobileMenuOpen">
        <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }"
          (click)="closeMobileMenu()">–ì–ª–∞–≤–Ω–∞—è</a>
        <a routerLink="/products" routerLinkActive="active" (click)="closeMobileMenu()">–ö–∞—Ç–∞–ª–æ–≥</a>
        <a routerLink="/cart" routerLinkActive="active" class="cart-link desktop-only" (click)="closeMobileMenu()">
          –ö–æ—Ä–∑–∏–Ω–∞ <span *ngIf="cartCount > 0" class="cart-badge">{{ cartCount }}</span>
        </a>
        <a routerLink="/news" routerLinkActive="active" (click)="closeMobileMenu()">–ù–æ–≤–æ—Å—Ç–∏</a>
        <a routerLink="/contact" routerLinkActive="active" (click)="closeMobileMenu()">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
        <a *ngIf="isLoggedIn" routerLink="/admin" routerLinkActive="active" (click)="closeMobileMenu()">–ê–¥–º–∏–Ω</a>
        <a routerLink="/about" routerLinkActive="active" (click)="closeMobileMenu()">–û –Ω–∞—Å</a>
        <a *ngIf="!isLoggedIn" routerLink="/login" routerLinkActive="active" (click)="closeMobileMenu()">–í—Ö–æ–¥</a>
        <a *ngIf="isLoggedIn" (click)="logout(); closeMobileMenu()" class="logout">–í—ã—Ö–æ–¥</a>
      </nav>
    </div>
  </div>
</header>

<main class="main-content">
  <router-outlet></router-outlet>
</main>

<div class="chat-widget" *ngIf="showChat && !isLoggedIn" [class.chat-open]="chatOpen">
  <div class="chat-header" (click)="toggleChat()">
    <span *ngIf="chatOpen">
      –ß–∞—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏
      <span *ngIf="chatNumber" class="chat-number">#{{ chatNumber }}</span>
    </span>
    <span class="toggle-icon">
      <span *ngIf="!chatOpen" class="chat-icon">üí¨</span>
      <span *ngIf="chatOpen">‚àí</span>
    </span>
  </div>
  <div class="chat-body" *ngIf="chatOpen">
    <div class="chat-messages" #chatMessagesContainer>
      <div *ngFor="let msg of chatMessages" class="message" [class.admin]="msg.isAdmin">
        <strong>{{ msg.username }}:</strong> {{ msg.message }}
      </div>
    </div>
    <div class="chat-input">
      <input [(ngModel)]="chatMessage" (keyup.enter)="sendMessage()" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
      <button (click)="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </div>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <div class="footer-content">
      <p>&copy; 2026 <span class="moto-text">MOTO</span>–º–∞—Ä–∫–µ—Ç. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
      <div class="footer-links">
        <a routerLink="/privacy">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
        <span class="separator">|</span>
        <a routerLink="/terms">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</a>
      </div>
    </div>
  </div>
</footer>

<app-terms-acceptance></app-terms-acceptance>

<app-edit-drawer *ngIf="editDrawerOpen" [entity]="editEntity" [entityType]="editEntityType" (close)="closeEditDrawer()"
  (saved)="onEntitySaved($event)">
</app-edit-drawer>