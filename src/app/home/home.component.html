<!-- Главный заголовок для SEO (скрыт визуально, но доступен для поисковиков) -->
<h1 class="visually-hidden">В интернет-магазине МотоМаркет вы можете купить мотоцикл, квадроцикл , мопед , скутер, и
  снегоход. А также : запчасти,
  экипировку и аксессуары. Широкий ассортимент, выгодные цены, профессиональная поддержка и быстрая доставка мототехники
  по Нижегородской области. Предоставляется рассрочка 0%. Надежные мототовары с гарантией : Avantis, JHL, Promax, BRZ,
  Vento, Motax, Kews, Osaca, Motolend, Kayo, Kugoo, Bashan, Groza, Zontes, RRF, Wild, Jilang, Loncin, VMC, Zummav, BOSS,
  Tezza, GT Racer, Bamx,Tank,Progasi, Colt, BSE, Sigma, Alpha, G-Moto, STN, Ataki, ATV, Bizon, Rinolil, Motul, Lavr,
  Mannol, Aimol hizer, GTX, IGP, X Tech, Nibbi и многое другое.</h1>

<!-- Слайдер -->
<section class="hero-slider">
  <div class="slider-container">
    <div class="slider-wrapper" [style.transform]="'translateX(-' + (currentSlide * 100) + '%)'">
      <div class="slide" *ngFor="let slide of slides; let i = index" [class.active]="i === currentSlide">
        <figure>
          <img [src]="slide.image" [alt]="slide.title">
        </figure>
        <div class="slide-content">
          <h2>{{ slide.title }}</h2>
          <p>{{ slide.description }}</p>
        </div>
      </div>
    </div>
    <div class="slider-indicators">
      <button *ngFor="let slide of slides; let i = index" [class.active]="i === currentSlide" (click)="goToSlide(i)"
        [attr.aria-label]="'Перейти к слайду ' + (i + 1)">
      </button>
    </div>
  </div>
</section>

<!-- Преимущества -->
<section class="advantages-section">
  <div class="container">
    <h2>Почему выбирают MOTOмаркет</h2>
    <ul class="advantages-grid">
      <li class="advantage-item">
        <div class="advantage-content">
          <div class="advantage-wrapper">
            <img class="advantage-icon" src="assets/icons/quality.svg" alt="Официальный дилер">
            <h3 class="advantage-title">
              Официальный дилер 15+ брендов с ассортиментом 100+ моделей
            </h3>
          </div>
          <div class="advantage-description">
            От скутеров до профессиональных мотоциклов и квадроциклов, от бюджетных моделей до премиум-класса. Все
            товары — напрямую от производителей, с гарантией подлинности и заводскими ценами
          </div>
        </div>
      </li>
      <li class="advantage-item">
        <div class="advantage-content">
          <div class="advantage-wrapper">
            <img class="advantage-icon" src="assets/icons/delivery.svg" alt="Доставка">
            <h3 class="advantage-title">
              Персонализированная доставка по всей России
            </h3>
          </div>
          <div class="advantage-description">
            Доставим заказ в любую точку России и в любом виде — полностью готовым к использованию или в разобранном
            виде — для самостоятельной сборки
          </div>
        </div>
      </li>
      <li class="advantage-item">
        <div class="advantage-content">
          <div class="advantage-wrapper">
            <img class="advantage-icon" src="assets/icons/warranty.svg" alt="Гарантия">
            <h3 class="advantage-title">
              Гарантия 12 месяцев + сервисная поддержка
            </h3>
          </div>
          <div class="advantage-description">
            Каждую единицу техники тщательно проверяем, смазываем узлы и протягиваем крепления перед отправкой. А после
            покупки вы получаете не только гарантию, но и помощь сервисного центра
          </div>
        </div>
      </li>
      <li class="advantage-item">
        <div class="advantage-content">
          <div class="advantage-wrapper">
            <img class="advantage-icon" src="assets/icons/payment.svg" alt="Оплата">
            <h3 class="advantage-title">
              Гибкие условия оплаты, которые могут подойти всем клиентам
            </h3>
          </div>
          <div class="advantage-description">
            Оформляйте заказ удаленно, платите после доставки. Никаких скрытых платежей — только прозрачные условия
          </div>
        </div>
      </li>
      <li class="advantage-item">
        <div class="advantage-content">
          <div class="advantage-wrapper">
            <img class="advantage-icon" src="assets/icons/selection.svg" alt="Подбор техники">
            <h3 class="advantage-title">
              Профессиональный подбор техники для каждого
            </h3>
          </div>
          <div class="advantage-description">
            Мы знаем рынок мототехники изнутри и поможем выбрать идеальный вариант — будь вы новичок или опытный райдер.
            Наш опыт — это 10+ лет работы и тысячи довольных клиентов
          </div>
        </div>
      </li>
      <li class="advantage-item">
        <div class="advantage-content">
          <div class="advantage-wrapper">
            <img class="advantage-icon" src="assets/icons/support.svg" alt="Поддержка">
            <h3 class="advantage-title">
              Поддержка на всех этапах: от выбора до первых поездок
            </h3>
          </div>
          <div class="advantage-description">
            Консультация перед покупкой от экспертов с десятилетним опытом и персональный консультант после покупки
          </div>
        </div>
      </li>
    </ul>
  </div>
</section>

<!-- Навигация по категориям (только для прокрутки к секциям категорий) -->
<section class="category-nav-section">
  <div class="container">
    <h2 class="visually-hidden">Навигация по категориям товаров</h2>
    <div class="scroll-container">
      <button *ngIf="hasScroll('category-nav')" class="scroll-btn scroll-btn-left"
        (click)="scrollHorizontal('category-nav', 'left')" [disabled]="!canScrollLeft('category-nav')"
        aria-label="Прокрутить влево">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M15 18l-6-6 6-6" />
        </svg>
      </button>
      <div class="category-nav" #categoryNav (scroll)="onScroll('category-nav')">
        <a (click)="scrollToCategory(null, $event)" class="category-link">
          Все товары
        </a>
        <a *ngFor="let category of categories" (click)="scrollToCategory(category.id, $event)" class="category-link">
          {{ category.name }}
        </a>
      </div>
      <button *ngIf="hasScroll('category-nav')" class="scroll-btn scroll-btn-right"
        (click)="scrollHorizontal('category-nav', 'right')" [disabled]="!canScrollRight('category-nav')"
        aria-label="Прокрутить вправо">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 18l6-6-6-6" />
        </svg>
      </button>
    </div>
  </div>
</section>

<!-- Поиск и фильтры -->
<section class="search-filters-section">
  <div class="container">
    <h2 class="visually-hidden">Поиск и фильтрация товаров</h2>
    <!-- Поиск -->
    <div class="search-section">
      <div class="search-box">
        <input type="text" [(ngModel)]="searchQuery" (input)="onSearchChange($any($event.target).value)"
          placeholder="Поиск товаров..." class="search-input">
        <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
          stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
      </div>
    </div>

    <!-- Сортировка и фильтры -->
    <div class="controls-section" *ngIf="searchQuery && searchQuery.trim() !== ''">
      <div class="controls-row">
        <div class="sort-controls">
          <select id="sortBy" [(ngModel)]="sortBy" (change)="onSortChange()" class="select-input compact-select">
            <option value="createdAt">По дате</option>
            <option value="name">По названию</option>
            <option value="price">По цене</option>
            <option value="stock">По наличию</option>
          </select>
          <select [(ngModel)]="sortOrder" (change)="onSortChange()" class="select-input compact-select">
            <option value="DESC">↓</option>
            <option value="ASC">↑</option>
          </select>
        </div>
        <button (click)="showFilters = !showFilters" class="filter-toggle-btn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
          </svg>
          Фильтры
        </button>
      </div>

      <!-- Панель фильтров -->
      <div class="filters-panel" [class.active]="showFilters">
        <div class="filter-group">
          <label>Категория:</label>
          <select [(ngModel)]="selectedCategory" class="select-input">
            <option [ngValue]="null">Все категории</option>
            <option *ngFor="let category of categories" [ngValue]="category.id">{{ category.name }}</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Цена: {{ priceRangeMin | number:'1.0-0' }}₽ - {{ priceRangeMax | number:'1.0-0' }}₽</label>
          <div class="price-range-container">
            <div class="dual-range-slider">
              <div class="slider-track" #sliderTrack>
                <div class="slider-progress" [style.left.%]="getMinPercent()" [style.width.%]="getRangePercent()">
                </div>
                <div class="slider-handle slider-handle-min" [style.left.%]="getMinPercent()"
                  (mousedown)="startDrag($event, 'min')" (touchstart)="startDrag($event, 'min')">
                </div>
                <div class="slider-handle slider-handle-max" [style.left.%]="getMaxPercent()"
                  (mousedown)="startDrag($event, 'max')" (touchstart)="startDrag($event, 'max')">
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="filter-group">
          <label>Наличие:</label>
          <select [(ngModel)]="inStock" class="select-input">
            <option [ngValue]="null">Все</option>
            <option [ngValue]="true">В наличии</option>
            <option [ngValue]="false">Нет в наличии</option>
          </select>
        </div>
        <div class="filter-actions">
          <button (click)="applyFilters()" class="apply-filters-btn">Применить</button>
          <button (click)="clearFilters()" class="clear-filters-btn">Сбросить фильтры</button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Результаты поиска -->
<section *ngIf="searchQuery && searchQuery.trim() !== ''" class="search-results-section">
  <div class="container">
    <h2>Результаты поиска</h2>
    <div *ngIf="loadingSearch" class="loading-message">
      <p>Поиск товаров...</p>
    </div>
    <div *ngIf="!loadingSearch && searchResults.length === 0" class="empty-message">
      <p>Товары не найдены</p>
    </div>
    <div *ngIf="!loadingSearch && searchResults.length > 0" class="scroll-container">
      <button *ngIf="hasScroll('search-results-grid')" class="scroll-btn scroll-btn-left"
        (click)="scrollHorizontal('search-results-grid', 'left')" [disabled]="!canScrollLeft('search-results-grid')"
        aria-label="Прокрутить влево">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M15 18l-6-6 6-6" />
        </svg>
      </button>
      <div class="products-grid" #searchResultsGrid (scroll)="onScroll('search-results-grid')">
        <article *ngFor="let product of searchResults" class="product-card">
          <a [routerLink]="['/products', product.id]">
            <figure class="product-image-wrapper">
              <img
                [src]="(product.images && product.images.length > 0 ? product.images[0] : null) || '/assets/placeholder.svg'"
                [alt]="product.name" (error)="$any($event.target).src='/assets/placeholder.svg'">
              <figcaption *ngIf="product.oldPrice" class="discount-badge">
                <mark>-{{ Math.round((1 - product.price / product.oldPrice) * 100) }}%</mark>
              </figcaption>
            </figure>
            <div class="product-content">
              <h3>{{ product.name }}</h3>
              <p *ngIf="product.description" class="description">{{ product.description | slice:0:100 }}...</p>
              <p class="price">
                <span *ngIf="product.oldPrice" class="old-price">{{ product.oldPrice | number:'1.0-0' }} ₽</span>
                <span class="current-price">{{ product.price | number:'1.0-0' }} ₽</span>
              </p>
              <div class="stock-actions-wrapper">
                <span *ngIf="product.stock >= 1" class="in-stock-badge">В наличии</span>
                <div class="actions" (click)="$event.preventDefault(); $event.stopPropagation();">
                  <div *ngIf="!isInCart(product.id) && product.stock > 0" class="cart-button-wrapper">
                    <button (click)="addToCart(product.id, $event)" class="btn-cart">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path d="M9 2L7 6m10 0l-2-4M3 6h18l-1 7H4L3 6zM4 13h16l-1 7H5l-1-7z" />
                        <circle cx="9" cy="20" r="1" />
                        <circle cx="20" cy="20" r="1" />
                      </svg>
                      В корзину
                    </button>
                  </div>
                  <div *ngIf="product.stock === 0" class="cart-button-wrapper">
                    <button (click)="openAvailabilityModal(product)" class="btn-cart">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                        <line x1="9" y1="10" x2="15" y2="10"></line>
                      </svg>
                      Уточнить о наличии
                    </button>
                  </div>
                  <div *ngIf="isInCart(product.id)" class="quantity-controls-card">
                    <button (click)="decreaseQuantity(getCartItem(product.id).id, product.id, $event)">−</button>
                    <span>{{ getCartItem(product.id).quantity }}</span>
                    <button (click)="increaseQuantity(getCartItem(product.id).id, product.id, $event)"
                      [disabled]="!canIncreaseQuantity(product.id)">+</button>
                  </div>
                  <button (click)="openInstallmentModal(product.name, product.price)" class="btn-installment">
                    Купить в рассрочку
                  </button>
                </div>
              </div>
            </div>
          </a>
        </article>
      </div>
      <button *ngIf="hasScroll('search-results-grid')" class="scroll-btn scroll-btn-right"
        (click)="scrollHorizontal('search-results-grid', 'right')" [disabled]="!canScrollRight('search-results-grid')"
        aria-label="Прокрутить вправо">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 18l6-6-6-6" />
        </svg>
      </button>
    </div>
  </div>
</section>

<!-- Популярные товары (показываются всегда, независимо от поиска) -->
<section class="featured-products">
  <div class="container">
    <h2>Популярные товары</h2>
    <div class="scroll-container">
      <button *ngIf="hasScroll('featured-products-grid')" class="scroll-btn scroll-btn-left"
        (click)="scrollHorizontal('featured-products-grid', 'left')"
        [disabled]="!canScrollLeft('featured-products-grid')" aria-label="Прокрутить влево">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M15 18l-6-6 6-6" />
        </svg>
      </button>
      <div class="products-grid" #featuredProductsGrid (scroll)="onScroll('featured-products-grid')">
        <article *ngFor="let product of featuredProducts" class="product-card">
          <a [routerLink]="['/products', product.id]">
            <figure>
              <img
                [src]="(product.images && product.images.length > 0 ? product.images[0] : null) || '/assets/placeholder.svg'"
                [alt]="product.name" (error)="$any($event.target).src='/assets/placeholder.svg'">
            </figure>
            <div class="product-content">
              <h3>{{ product.name }}</h3>
              <p class="price">
                <span *ngIf="product.oldPrice" class="old-price">{{ product.oldPrice | number:'1.0-0' }} ₽</span>
                <span class="current-price">{{ product.price | number:'1.0-0' }} ₽</span>
              </p>
              <div class="stock-actions-wrapper">
                <span *ngIf="product.stock >= 1" class="in-stock-badge">В наличии</span>
                <div class="actions" (click)="$event.preventDefault(); $event.stopPropagation();">
                  <div *ngIf="!isInCart(product.id) && product.stock > 0" class="cart-button-wrapper">
                    <button (click)="addToCart(product.id, $event)" class="btn-cart">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path d="M9 2L7 6m10 0l-2-4M3 6h18l-1 7H4L3 6zM4 13h16l-1 7H5l-1-7z" />
                        <circle cx="9" cy="20" r="1" />
                        <circle cx="20" cy="20" r="1" />
                      </svg>
                      В корзину
                    </button>
                  </div>
                  <div *ngIf="product.stock === 0" class="cart-button-wrapper">
                    <button (click)="openAvailabilityModal(product)" class="btn-cart">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                        <line x1="9" y1="10" x2="15" y2="10"></line>
                      </svg>
                      Уточнить о наличии
                    </button>
                  </div>
                  <div *ngIf="isInCart(product.id)" class="quantity-controls-card">
                    <button (click)="decreaseQuantity(getCartItem(product.id).id, product.id, $event)">−</button>
                    <span>{{ getCartItem(product.id).quantity }}</span>
                    <button (click)="increaseQuantity(getCartItem(product.id).id, product.id, $event)"
                      [disabled]="!canIncreaseQuantity(product.id)">+</button>
                  </div>
                  <button (click)="openInstallmentModal(product.name, product.price)" class="btn-installment">
                    Купить в рассрочку
                  </button>
                </div>
              </div>
            </div>
          </a>
        </article>
      </div>
      <button *ngIf="hasScroll('featured-products-grid')" class="scroll-btn scroll-btn-right"
        (click)="scrollHorizontal('featured-products-grid', 'right')"
        [disabled]="!canScrollRight('featured-products-grid')" aria-label="Прокрутить вправо">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 18l6-6-6-6" />
        </svg>
      </button>
    </div>
  </div>
</section>

<section class="catalog-preview">
  <div class="container">
    <h2>Каталог мототехники по категориям</h2>
    <!-- Товары по категориям -->
    <div *ngFor="let category of categories" [id]="'category-' + category.id" class="category-section">
      <div class="category-header">
        <a (click)="goToCatalog(category.id, $event)" class="category-title-link">
          <h3>Категория: {{ category.name }}</h3>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7" />
          </svg>
        </a>
      </div>
      <div class="scroll-container">
        <button *ngIf="hasScroll('category-' + category.id)" class="scroll-btn scroll-btn-left"
          (click)="scrollHorizontal('category-' + category.id, 'left')"
          [disabled]="!canScrollLeft('category-' + category.id)" aria-label="Прокрутить влево">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M15 18l-6-6 6-6" />
          </svg>
        </button>
        <div class="products-grid" [attr.id]="'category-grid-' + category.id"
          (scroll)="onScroll('category-' + category.id)">
          <article *ngFor="let product of getCategoryProducts(category.id)" class="product-card">
            <a [routerLink]="['/products', product.id]">
              <figure>
                <img
                  [src]="(product.images && product.images.length > 0 ? product.images[0] : null) || '/assets/placeholder.svg'"
                  [alt]="product.name" (error)="$any($event.target).src='/assets/placeholder.svg'">
              </figure>
              <div class="product-content">
                <h3>{{ product.name }}</h3>
                <p class="price">
                  <span *ngIf="product.oldPrice" class="old-price">{{ product.oldPrice | number:'1.0-0' }} ₽</span>
                  <span class="current-price">{{ product.price | number:'1.0-0' }} ₽</span>
                </p>
                <div class="stock-actions-wrapper">
                  <span *ngIf="product.stock >= 1" class="in-stock-badge">В наличии</span>
                  <div class="actions" (click)="$event.preventDefault(); $event.stopPropagation();">
                    <div *ngIf="!isInCart(product.id) && product.stock > 0" class="cart-button-wrapper">
                      <button (click)="addToCartFromCategory(product, $event)" class="btn-cart">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                          stroke-width="2">
                          <path d="M9 2L7 6m10 0l-2-4M3 6h18l-1 7H4L3 6zM4 13h16l-1 7H5l-1-7z" />
                          <circle cx="9" cy="20" r="1" />
                          <circle cx="20" cy="20" r="1" />
                        </svg>
                        В корзину
                      </button>
                    </div>
                    <div *ngIf="product.stock === 0" class="cart-button-wrapper">
                      <button (click)="openAvailabilityModal(product)" class="btn-cart">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                          stroke-width="2">
                          <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                          <line x1="9" y1="10" x2="15" y2="10"></line>
                        </svg>
                        Уточнить о наличии
                      </button>
                    </div>
                    <div *ngIf="isInCart(product.id)" class="quantity-controls-card">
                      <button (click)="decreaseQuantityFromCategory(product, $event)">−</button>
                      <span>{{ getCartItem(product.id).quantity }}</span>
                      <button (click)="increaseQuantityFromCategory(product, $event)"
                        [disabled]="!canIncreaseQuantityForProduct(product)">+</button>
                    </div>
                    <button (click)="openInstallmentModal(product.name, product.price)" class="btn-installment">
                      Купить в рассрочку
                    </button>
                  </div>
                </div>
              </div>
            </a>
          </article>
        </div>
        <button *ngIf="hasScroll('category-' + category.id)" class="scroll-btn scroll-btn-right"
          (click)="scrollHorizontal('category-' + category.id, 'right')"
          [disabled]="!canScrollRight('category-' + category.id)" aria-label="Прокрутить вправо">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 18l6-6-6-6" />
          </svg>
        </button>
      </div>
    </div>
  </div>
</section>

<section class="latest-news">
  <div class="container">
    <h2>Последние новости</h2>
    <div class="news-grid">
      <article *ngFor="let news of latestNews" class="news-card">
        <figure *ngIf="news.image">
          <img [src]="news.image" [alt]="news.title">
        </figure>
        <div *ngIf="!news.image" class="news-placeholder" role="img" aria-label="Нет изображения">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="3" y1="9" x2="21" y2="9"></line>
            <line x1="9" y1="21" x2="9" y2="9"></line>
          </svg>
        </div>
        <h3>{{ news.title }}</h3>
        <p>{{ news.content | slice:0:150 }}...</p>
        <a [routerLink]="['/news', news.id]">Читать далее</a>
      </article>
    </div>
  </div>
</section>